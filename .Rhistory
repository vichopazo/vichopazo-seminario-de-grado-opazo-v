class(meta$Year)
View(output)
data_proc <- textProcessor(documents$text, metadata = meta_ungdc_chile)
data_proc <- textProcessor(documents$text, metadata = meta_ungdc_chile)
output <- prepDocuments(data_proc$documents, data_proc$vocab, data_proc$meta, lower.thresh = 1, upper.thresh = 52)
docs <- output$documents
vocab <- output$vocab
vocab <- output$vocab
meta <-output$meta
View(output)
View(meta_ungdc_chile)
knitr::opts_chunk$set(echo = TRUE)
library(pacman)
pacman::p_load(readr,
stm,
dplyr,
openxlsx,
readtext,
quanteda,
igraph)
url <- "https://www.researchgate.net/profile/Vicente_Opazo/publication/363844089_UN_General_Debate_Corpus_Chile_1971-2022/data/634ca5809cb4fe44f32f306d/UNGDC-Chile-1971-2022.zip"
download.file(url, "UNGC_Chile.zip")
unzip("UNGC_Chile.zip")
url2 <- "https://www.researchgate.net/profile/Vicente_Opazo/publication/363844089_UN_General_Debate_Corpus_Chile_1971-2022/data/63687a2237878b3e878a348f/metadata-UNGDC-Chile-1971-2022.xlsx"
url2 <- "https://www.researchgate.net/profile/Vicente_Opazo/publication/363844089_UN_General_Debate_Corpus_Chile_1971-2022/data/63687a2237878b3e878a348f/metadata-UNGDC-Chile-1971-2022.xlsx"
download.file(url2, "metadata_UNGDC_Chile_1971_2022.xlsx", quiet = TRUE, mode = "wb")
documents <- readtext("UNGDC_Chile_1971_2022",
ignore_missing_files = FALSE,
text_field = NULL,
docid_field = NULL)
meta_ungdc_chile <- read.xlsx("metadata_UNGDC_Chile_1971_2022.xlsx", sheet = 1)
class(meta_ungdc_chile$Gov.Rating)
meta_ungdc_chile$Gov.Rating <- as.factor(meta_ungdc_chile$Gov.Rating)
class(meta_ungdc_chile$Gov.Rating)
data_proc <- textProcessor(documents$text, metadata = meta_ungdc_chile)
output <- prepDocuments(data_proc$documents, data_proc$vocab, data_proc$meta, lower.thresh = 1, upper.thresh = 52)
docs <- output$documents
vocab <- output$vocab
meta <-output$meta
View(data_proc)
meta_ungdc_chile <- read.xlsx("metadata_UNGDC_Chile_1971_2022.xlsx", sheet = 1)
meta_ungdc_chile$Gov.Rating <- as.factor(meta_ungdc_chile$Gov.Rating)
meta_ungdc_chile$Year <- as.numeric(meta_ungdc_chile$Year)
data_proc <- textProcessor(documents$text, metadata = meta_ungdc_chile)
output <- prepDocuments(data_proc$documents, data_proc$vocab, data_proc$meta, lower.thresh = 1, upper.thresh = 52)
docs <- output$documents
vocab <- output$vocab
meta <-output$meta
View(data_proc)
View(output)
meta_ungdc_chile$Gov.Rating <- as.factor(meta_ungdc_chile$Gov.Rating)
data_proc <- textProcessor(documents$text, metadata = meta_ungdc_chile)
data_proc <- textProcessor(documents$text, metadata = meta_ungdc_chile)
output <- prepDocuments(data_proc$documents, data_proc$vocab, data_proc$meta, lower.thresh = 1, upper.thresh = 52)
docs <- output$documents
vocab <- output$vocab
vocab <- output$vocab
meta <-output$meta
typeof(meta$Year)
meta_ungdc_chile <- read.xlsx("metadata_UNGDC_Chile_1971_2022.xlsx", sheet = 1)
meta_ungdc_chile$Gov.Rating <- as.factor(meta_ungdc_chile$Gov.Rating)
meta_ungdc_chile$Year <- as.integer(meta_ungdc_chile$Year)
data_proc <- textProcessor(documents$text, metadata = meta_ungdc_chile)
output <- prepDocuments(data_proc$documents, data_proc$vocab, data_proc$meta, lower.thresh = 1, upper.thresh = 52)
docs <- output$documents
vocab <- output$vocab
meta <-output$meta
typeof(Year)
typeof(meta$Year)
class(meta$Year)
View(output)
STM <- stm(documents = output$documents, vocab = output$vocab,
K = 5, prevalence =~ Gov.Rating + s(Year),
max.em.its = 75, data = output$meta,
init.type = "Spectral", verbose = FALSE)
plot(STM)
plot(STM, type = "labels", n = 7, labeltype = "prob", topic.names = c("1. Human rights, democracy and economic development", "2. Chilean internal politics", "3. UN relevant bodies' role on Latin American issues", "4. Co-operation in line with non-interference principle", "5. Environmental issues"), width = 80)
set.seed(87)
cloud(STM, topic=3, max.words = 20)
set.seed(89)
cloud(STM, topic=5, max.words = 20)
predict_topics <- estimateEffect(formula =~ Gov.Rating + s(Year), stmobj = STM, metadata = output$meta, uncertainty = "Global")
plot(predict_topics, covariate = "Gov.Rating", topics = 3,
model = STM, method = "pointestimate",
xlab = "Mean topic proportion: UN relevant bodies' role on Latin American issues",
main = "Effect of Political Position (Left-Right Axis)",
labeltype = "custom",
custom.labels = c("Left-wing", "Centre-right", "Centre-left", "Centre", "Right-wing"))
plot(predict_topics, covariate = "Gov.Rating", topics = 1,
model = STM, method = "pointestimate",
xlab = "Mean topic proportion: Human rights, democracy and economic development",
main = "Effect of Political Position (Left-Right Axis)",
labeltype = "custom",
custom.labels = c("Left-wing", "Centre-right", "Centre-left", "Centre", "Right-wing"))
plot(predict_topics, covariate = "Gov.Rating", topics = 5,
model = STM, method = "pointestimate",
xlab = "Mean topic proportion: Environmental issues",
main = "Effect of Political Position (Left-Right Axis)",
labeltype = "custom",
custom.labels = c("Left-wing", "Centre-right", "Centre-left", "Centre", "Right-wing"))
plot(predict_topics, covariate = "Gov.Rating", topics = 1, #experiment
model = STM, method = "pointestimate",
main = "Effect of Political Position (Left-Right Axis)")
View(meta)
plot(predict_topics, "Year", method = "continuous", topics = 1,
model = z, printlegend = FALSE, xaxt = "n", xlab = "Time in years (1971-2022)")
plot(predict_topics, "Year", method = "continuous", topics = 5,
model = z, printlegend = FALSE, xaxt = "n", xlab = "Time in years (1971-2022)")
STM <- stm(documents = output$documents, vocab = output$vocab,
K = 5, prevalence =~ Gov.Rating + log(Year),
max.em.its = 75, data = output$meta,
init.type = "Spectral", verbose = FALSE)
plot(STM)
labelTopics(STM) #check probability (prob) + frequency & exclusivity (frex)
set.seed(930)
cloud(STM, topic=1, max.words = 30)
cloud(STM, topic=2, max.words = 30)
cloud(STM, topic=3, max.words = 30)
cloud(STM, topic=4, max.words = 30)
cloud(STM, topic=5, max.words = 30)
plot(STM, type = "labels", n = 7, labeltype = "prob", topic.names = c("1. Human rights, democracy and economic development", "2. Chilean internal politics", "3. UN relevant bodies' role on Latin American issues", "4. Co-operation in line with non-interference principle", "5. Environmental issues"), width = 80)
predict_topics <- estimateEffect(formula =~ Gov.Rating + log(Year), stmobj = STM, metadata = output$meta, uncertainty = "Global")
plot(predict_topics, covariate = "Gov.Rating", topics = 3,
model = STM, method = "pointestimate",
xlab = "Mean topic proportion: UN relevant bodies' role on Latin American issues",
main = "Effect of Political Position (Left-Right Axis)",
labeltype = "custom",
custom.labels = c("Left-wing", "Centre-right", "Centre-left", "Centre", "Right-wing"))
plot(predict_topics, covariate = "Gov.Rating", topics = 1,
model = STM, method = "pointestimate",
xlab = "Mean topic proportion: Human rights, democracy and economic development",
main = "Effect of Political Position (Left-Right Axis)",
labeltype = "custom",
custom.labels = c("Left-wing", "Centre-right", "Centre-left", "Centre", "Right-wing"))
class(meta$Year)
class(meta$Gov.Rating)
plot(predict_topics, covariate = "Gov.Rating", topics = 5,
model = STM, method = "pointestimate",
xlab = "Mean topic proportion: Environmental issues",
main = "Effect of Political Position (Left-Right Axis)",
labeltype = "custom",
custom.labels = c("Left-wing", "Centre-right", "Centre-left", "Centre", "Right-wing"))
plot(predict_topics, covariate = "Gov.Rating", topics = 3,
model = STM, method = "pointestimate",
xlab = "Mean topic proportion: UN relevant bodies' role on Latin American issues",
main = "Effect of Political Position (Left-Right Axis)",
labeltype = "custom",
custom.labels = c("Left-wing", "Centre-right", "Centre-left", "Centre", "Right-wing"))
plot(predict_topics, covariate = "Gov.Rating", topics = 1,
model = STM, method = "pointestimate",
xlab = "Mean topic proportion: Human rights, democracy and economic development",
main = "Effect of Political Position (Left-Right Axis)",
labeltype = "custom",
custom.labels = c("Left-wing", "Centre-right", "Centre-left", "Centre", "Right-wing"))
plot(predict_topics, covariate = "Gov.Rating", topics = 1, #experiment
model = STM, method = "pointestimate",
main = "Effect of Political Position (Left-Right Axis)")
plot(predict_topics, "Year", method = "continuous", topics = 5,
model = z, printlegend = FALSE, xaxt = "n", xlab = "Time in years (1971-2022)")
plot(predict_topics, covariate = "Year", method = "continuous", topics = 5,
model = z, printlegend = FALSE, xaxt = "n", xlab = "Time in years (1971-2022)")
plot(predict_topics, covariate = "Year", method = "continuous", topics = c(5, 3),
model = z, printlegend = FALSE, xaxt = "n", xlab = "Time in years (1971-2022)")
STM <- stm(documents = output$documents, vocab = output$vocab,
K = 5, prevalence =~ Gov.Rating + s(Year),
max.em.its = 75, data = output$meta,
init.type = "Spectral", verbose = FALSE)
plot(STM)
labelTopics(STM) #check probability (prob) + frequency & exclusivity (frex)
findThoughts(STM, texts = documents$text,
n = 1, topics = 5)
plot(STM, type = "labels", n = 7, labeltype = "prob", topic.names = c("1. Human rights, democracy and economic development", "2. Chilean internal politics", "3. UN relevant bodies' role on Latin American issues", "4. Co-operation in line with non-interference principle", "5. Environmental issues"), width = 80)
set.seed(87)
cloud(STM, topic=3, max.words = 20)
set.seed(89)
cloud(STM, topic=5, max.words = 20)
predict_topics <- estimateEffect(formula =~ Gov.Rating + s(Year), stmobj = STM, metadata = output$meta, uncertainty = "Global")
plot(predict_topics, covariate = "Gov.Rating", topics = 3,
model = STM, method = "pointestimate",
xlab = "Mean topic proportion: UN relevant bodies' role on Latin American issues",
main = "Effect of Political Position (Left-Right Axis)",
labeltype = "custom",
custom.labels = c("Left-wing", "Centre-right", "Centre-left", "Centre", "Right-wing"))
plot(predict_topics, covariate = "Gov.Rating", topics = 1,
model = STM, method = "pointestimate",
xlab = "Mean topic proportion: Human rights, democracy and economic development",
main = "Effect of Political Position (Left-Right Axis)",
labeltype = "custom",
custom.labels = c("Left-wing", "Centre-right", "Centre-left", "Centre", "Right-wing"))
plot(predict_topics, covariate = "Gov.Rating", topics = 5,
model = STM, method = "pointestimate",
xlab = "Mean topic proportion: Environmental issues",
main = "Effect of Political Position (Left-Right Axis)",
labeltype = "custom",
custom.labels = c("Left-wing", "Centre-right", "Centre-left", "Centre", "Right-wing"))
plot(predict_topics, covariate = "Gov.Rating", topics = 3,
model = STM, method = "pointestimate",
xlab = "Mean topic proportion: UN relevant bodies' role on Latin American issues",
main = "Effect of Political Position (Left-Right Axis)",
labeltype = "custom",
custom.labels = c("Left-wing", "Centre-right", "Centre-left", "Centre", "Right-wing"))
plot(predict_topics, covariate = "Gov.Rating", topics = 1,
model = STM, method = "pointestimate",
xlab = "Mean topic proportion: Human rights, democracy and economic development",
main = "Effect of Political Position (Left-Right Axis)",
labeltype = "custom",
custom.labels = c("Left-wing", "Centre-right", "Centre-left", "Centre", "Right-wing"))
plot(predict_topics, covariate = "Gov.Rating", topics = 5,
model = STM, method = "pointestimate",
xlab = "Mean topic proportion: Environmental issues",
main = "Effect of Political Position (Left-Right Axis)",
labeltype = "custom",
custom.labels = c("Left-wing", "Centre-right", "Centre-left", "Centre", "Right-wing"))
plot(predict_topics, covariate = "Gov.Rating", topics = 5,
model = STM, method = "pointestimate",
xlab = "Mean topic proportion: Environmental issues",
main = "Effect of Political Position (Left-Right Axis)",
labeltype = "custom",
custom.labels = c("Left-wing", "Centre-right", "Centre-left", "Centre", "Right-wing"))
plot(STM, type = "labels", n = 7, labeltype = "prob", topic.names = c("1. Human rights, democracy and economic development", "2. Chilean internal politics", "3. UN relevant bodies' role on Latin American issues", "4. Co-operation in line with non-interference principle", "5. Environmental issues"), width = 80)
labelTopics(STM) #check probability (prob) + frequency & exclusivity (frex)
predict_topics <- estimateEffect(formula =~ Gov.Rating + s(Year), stmobj = STM, metadata = output$meta, uncertainty = "Global")
plot(predict_topics, covariate = "Gov.Rating", topics = 3,
model = STM, method = "pointestimate",
xlab = "Mean topic proportion: UN relevant bodies' role on Latin American issues",
main = "Effect of Political Position (Left-Right Axis)",
labeltype = "custom",
custom.labels = c("Left-wing", "Centre-right", "Centre-left", "Centre", "Right-wing"))
plot(predict_topics, covariate = "Gov.Rating", topics = 1,
model = STM, method = "pointestimate",
xlab = "Mean topic proportion: Human rights, democracy and economic development",
main = "Effect of Political Position (Left-Right Axis)",
labeltype = "custom",
custom.labels = c("Left-wing", "Centre-right", "Centre-left", "Centre", "Right-wing"))
plot(predict_topics, covariate = "Gov.Rating", topics = 5,
model = STM, method = "pointestimate",
xlab = "Mean topic proportion: Environmental issues",
main = "Effect of Political Position (Left-Right Axis)",
labeltype = "custom",
custom.labels = c("Left-wing", "Centre-right", "Centre-left", "Centre", "Right-wing"))
plot(predict_topics, covariate = "Gov.Rating", topics = 1, #experiment
model = STM, method = "pointestimate",
main = "Effect of Political Position (Left-Right Axis)")
plot(predict_topics, covariate = "Year", method = "continuous", topics = c(5, 3),
model = z, printlegend = FALSE, xaxt = "n", xlab = "Time in years (1971-2022)")
plot(predict_topics, covariate = "Year", method = "continuous", topics = 5,
model = z, printlegend = FALSE, xaxt = "n", xlab = "Time in years (1971-2022)")
STM <- stm(documents = output$documents, vocab = output$vocab,
K = 5, prevalence =~ Gov.Rating + log(Year),
max.em.its = 75, data = output$meta,
init.type = "Spectral", verbose = FALSE)
plot(STM)
labelTopics(STM) #check probability (prob) + frequency & exclusivity (frex)
findThoughts(STM, texts = documents$text,
n = 1, topics = 3)
findThoughts(STM, texts = documents$text,
n = 1, topics = 4)
set.seed(930)
cloud(STM, topic=1, max.words = 30)
cloud(STM, topic=2, max.words = 30)
cloud(STM, topic=3, max.words = 30)
cloud(STM, topic=4, max.words = 30)
cloud(STM, topic=5, max.words = 30)
plot(STM, type = "labels", n = 7, labeltype = "prob", topic.names = c("1. Human rights, democracy and economic development", "2. Chilean internal politics", "3. UN relevant bodies' role on Latin American issues", "4. Co-operation in line with non-interference principle", "5. Environmental issues"), width = 80)
predict_topics <- estimateEffect(formula =~ Gov.Rating + log(Year), stmobj = STM, metadata = output$meta, uncertainty = "Global")
plot(predict_topics, covariate = "Gov.Rating", topics = 3,
model = STM, method = "pointestimate",
xlab = "Mean topic proportion: UN relevant bodies' role on Latin American issues",
main = "Effect of Political Position (Left-Right Axis)",
labeltype = "custom",
custom.labels = c("Left-wing", "Centre-right", "Centre-left", "Centre", "Right-wing"))
plot(predict_topics, covariate = "Gov.Rating", topics = 1,
model = STM, method = "pointestimate",
xlab = "Mean topic proportion: Human rights, democracy and economic development",
main = "Effect of Political Position (Left-Right Axis)",
labeltype = "custom",
custom.labels = c("Left-wing", "Centre-right", "Centre-left", "Centre", "Right-wing"))
plot(predict_topics, covariate = "Gov.Rating", topics = 5,
model = STM, method = "pointestimate",
xlab = "Mean topic proportion: Environmental issues",
main = "Effect of Political Position (Left-Right Axis)",
labeltype = "custom",
custom.labels = c("Left-wing", "Centre-right", "Centre-left", "Centre", "Right-wing"))
plot(predict_topics, covariate = "Gov.Rating", topics = 1, #experiment
model = STM, method = "pointestimate",
main = "Effect of Political Position (Left-Right Axis)")
plot(predict_topics, covariate = "Year", method = "continuous", topics = 5,
model = z, printlegend = FALSE, xaxt = "n", xlab = "Time in years (1971-2022)")
yearseq <- seq(from = 1971, to = 2022, by = "year")
yearseq <- seq(from = 1971, to = 2022)
yearseq <- seq(from = as.Date = 1971, to = as.Date = 2022)
yearseq <- seq(from = as.Date = "1971", to = as.Date = "2022")
yearseq <- seq(from = as.Date(1971), to = (2022)
yearseq <- seq(from = as.Date(1971), to = as.Date(2022)
plot(predict_topics, "Year", method = "continuous", topics = 5,
model = z, printlegend = FALSE, xaxt = "n", xlab = "Time in years (1971-2022)")
axis(labels = TRUE)
axis(labels = TRUE, side = 1)
plot(predict_topics, "Year", method = "continuous", topics = 5,
model = z, printlegend = FALSE, xaxt = "n", xlab = "Time in years (1971-2022)")
axis(labels = TRUE, side = 1)
??plot.new
plot(predict_topics, "Year", method = "continuous", topics = 5,
model = z, printlegend = FALSE, xaxt = "n", xlab = "Time in years (1971-2022)")
axis(1, labels = TRUE)
axis(as.numeric("Year")
plot(predict_topics, "Year", method = "continuous", topics = 5,
axis(as.numeric("Year")
plot(predict_topics, "Year", method = "continuous", topics = 5,
plot(predict_topics, "Year", method = "continuous", topics = 5,
model = z, printlegend = FALSE, xaxt = "n", xlab = "Time in years (1971-2022)")
axis(at = as.numeric("Year")
plot(predict_topics, "Year", method = "continuous", topics = 5,
axis(1, at = as.numeric("Year"), - min(as.numeric("Year")
plot(predict_topics, "Year", method = "continuous", topics = 5,
plot(predict_topics, "Year", method = "continuous", topics = 5,
model = z, printlegend = FALSE, xaxt = "n", xlab = "Time in years (1971-2022)")
yearseq <- seq(from = as.Date("1971-01-01"),
to = as.Date("2022-12-01"), by = "year")
axis(1,at = as.numeric(monthseq) - min(as.numeric(monthseq)),
labels = yearseq)
yearseq <- seq(from = as.Date("1971-01-01"),
to = as.Date("2022-12-01"), by = "year")
yearseq <- seq(from = as.Date.numeric("1971"),
to = as.Date.numeric("2022"), by = "year")
yearseq <- seq(from = as.Date("1971"),
to = as.Date("2022"), by = "year")
yearseq <- seq(from = as.Date("1971-01-01"),
to = as.Date("2022-22-12"), by = "year")
yearseq <- seq(from = as.Date("1971-01-01"),
to = as.Date("2022-12-01"), by = "year")
axis(1,at = as.numeric(yearseq) - min(as.numeric(yearseq)),
labels = yearseq)
plot(predict_topics, "Year", method = "continuous", topics = 5,
model = z, printlegend = FALSE, xaxt = "n", xlab = "Time in years (1971-2022)")
yearseq <- seq(from = as.Date("1971-01-01"),
to = as.Date("2022-12-01"), by = "year")
axis(1,at = as.numeric(yearseq) - min(as.numeric(yearseq)),
labels = yearseq)
plot.new
yearnames <- years(yearseq)
yearseq <- seq(from = 1971, to = 2022)
axis(yearseq)
plot(predict_topics, "Year", method = "continuous", topics = 5,
model = z, printlegend = FALSE, xaxt = "n", xlab = "Time in years (1971-2022)")
plot(predict_topics, "Year", method = "continuous", topics = 5,
model = z, printlegend = FALSE, xaxt = "n", xlab = "Time in years (1971-2022)", labels("Year"))
plot(predict_topics, "Year", method = "continuous", topics = 5,
model = z, printlegend = FALSE, xaxt = "n", xlab = "Time in years (1971-2022)", labels("Year"))
plot(predict_topics, "Year", method = "continuous", topics = 5,
model = z, printlegend = TRUE, xaxt = "n", xlab = "Time in years (1971-2022)", labels("Year"))
plot(predict_topics, "Year", method = "continuous", topics = 5,
model = z, printlegend = FALSE, xaxt = "n", xlab = "Time in years (1971-2022)", labels("Year"))
plot(predict_topics, "Year", method = "continuous", topics = 5,
model = STM, printlegend = FALSE, xaxt = "n", xlab = "Time in years (1971-2022)", labels("Year"))
plot(predict_topics, "Year", method = "continuous", topics = 5,
model = z, printlegend = FALSE, xaxt = "n", xlab = "Time in years (1971-2022)", labels("Year"))
plot(x = predict_topics, covariate = "Year", method = "continuous", topics = 5,
model = STM, xlab = "Time in years (1971-2022)")
plot(x = predict_topics, covariate = "Year", method = "continuous", topics = c(5, 3, 1),
model = STM, xlab = "Time in years (1971-2022)")
plot(x = predict_topics, covariate = "Year", method = "continuous", topics = c(5, 3),
model = STM, xlab = "Time in years (1971-2022)")
labelTopics(STM) #check probability (prob) + frequency & exclusivity (frex)
STM <- stm(documents = output$documents, vocab = output$vocab,
K = 5, prevalence =~ log(Year),
max.em.its = 75, data = output$meta,
init.type = "Spectral", verbose = FALSE)
plot(STM)
labelTopics(STM) #check probability (prob) + frequency & exclusivity (frex)
plot(STM, type = "labels", n = 7, labeltype = "prob", topic.names = c("1. Human rights, democracy and economic development", "2. Chilean internal politics", "3. UN relevant bodies' role on Latin American issues", "4. Co-operation in line with non-interference principle", "5. Environmental issues"), width = 80)
predict_topics <- estimateEffect(formula =~ log(Year), stmobj = STM, metadata = output$meta, uncertainty = "Global")
plot(predict_topics, covariate = "Gov.Rating", topics = 3,
model = STM, method = "pointestimate",
xlab = "Mean topic proportion: UN relevant bodies' role on Latin American issues",
main = "Effect of Political Position (Left-Right Axis)",
labeltype = "custom",
custom.labels = c("Left-wing", "Centre-right", "Centre-left", "Centre", "Right-wing"))
plot(x = predict_topics, covariate = "Year", method = "continuous", topics = c(5, 3),
model = STM, xlab = "Time in years (1971-2022)")
STM <- stm(documents = output$documents, vocab = output$vocab,
K = 5, prevalence =~ Gov.Rating + s(Year),
max.em.its = 75, data = output$meta,
init.type = "Spectral", verbose = FALSE)
predict_topics <- estimateEffect(formula =~ Gov.Rating + s(Year), stmobj = STM, metadata = output$meta, uncertainty = "Global")
plot(predict_topics, covariate = "Gov.Rating", topics = 3,
model = STM, method = "pointestimate",
xlab = "Mean topic proportion: UN relevant bodies' role on Latin American issues",
main = "Effect of Political Position (Left-Right Axis)",
labeltype = "custom",
custom.labels = c("Left-wing", "Centre-right", "Centre-left", "Centre", "Right-wing"))
plot(predict_topics, covariate = "Gov.Rating", topics = 1,
model = STM, method = "pointestimate",
xlab = "Mean topic proportion: Human rights, democracy and economic development",
main = "Effect of Political Position (Left-Right Axis)",
labeltype = "custom",
custom.labels = c("Left-wing", "Centre-right", "Centre-left", "Centre", "Right-wing"))
plot(predict_topics, covariate = "Gov.Rating", topics = 5,
model = STM, method = "pointestimate",
xlab = "Mean topic proportion: Environmental issues",
main = "Effect of Political Position (Left-Right Axis)",
labeltype = "custom",
custom.labels = c("Left-wing", "Centre-right", "Centre-left", "Centre", "Right-wing"))
plot(predict_topics, covariate = "Gov.Rating", topics = 1, #experiment
model = STM, method = "pointestimate",
main = "Effect of Political Position (Left-Right Axis)")
plot(STM)
plot(STM, type = "labels", n = 7, labeltype = "prob", topic.names = c("1. Human rights, democracy and economic development", "2. Chilean internal politics", "3. UN relevant bodies' role on Latin American issues", "4. Co-operation in line with non-intervention principle", "5. Environmental issues"), width = 80)
plot(predict_topics, covariate = "Gov.Rating", topics = 4,
model = STM, method = "pointestimate",
xlab = "Mean topic proportion: Co-operation in line with non-intervention principle",
main = "Effect of Political Position (Left-Right Axis)",
labeltype = "custom",
custom.labels = c("Left-wing", "Centre-right", "Centre-left", "Centre", "Right-wing"))
plot(predict_topics, covariate = "Gov.Rating", topics = 5,
model = STM, method = "pointestimate",
xlab = "Mean topic proportion: Environmental issues",
main = "Effect of Political Position (Left-Right Axis)",
labeltype = "custom",
custom.labels = c("Left-wing", "Centre-right", "Centre-left", "Centre", "Right-wing"))
plot(x = predict_topics, covariate = "Year", method = "continuous", topics = c(5, 3),
model = STM, xlab = "Time in years (1971-2022)")
plot(x = predict_topics, covariate = "Year", method = "continuous", topics = c(5),
model = STM, xlab = "Time in years (1971-2022)")
class(meta$Year)
STM <- stm(documents = output$documents, vocab = output$vocab,
K = 5, prevalence =~ Gov.Rating + Year,
max.em.its = 75, data = output$meta,
init.type = "Spectral", verbose = FALSE)
plot(STM)
labelTopics(STM) #check probability (prob) + frequency & exclusivity (frex)
plot(STM, type = "labels", n = 7, labeltype = "prob", topic.names = c("1. Human rights, democracy and economic development", "2. Chilean internal politics", "3. UN relevant bodies' role on Latin American issues", "4. Co-operation in line with non-intervention principle", "5. Environmental issues"), width = 80)
predict_topics <- estimateEffect(formula =~ Gov.Rating + Year, stmobj = STM, metadata = output$meta, uncertainty = "Global")
plot(predict_topics, covariate = "Gov.Rating", topics = 3,
model = STM, method = "pointestimate",
xlab = "Mean topic proportion: UN relevant bodies' role on Latin American issues",
main = "Effect of Political Position (Left-Right Axis)",
labeltype = "custom",
custom.labels = c("Left-wing", "Centre-right", "Centre-left", "Centre", "Right-wing"))
plot(predict_topics, covariate = "Gov.Rating", topics = 4,
model = STM, method = "pointestimate",
xlab = "Mean topic proportion: Co-operation in line with non-intervention principle",
main = "Effect of Political Position (Left-Right Axis)",
labeltype = "custom",
custom.labels = c("Left-wing", "Centre-right", "Centre-left", "Centre", "Right-wing"))
plot(predict_topics, covariate = "Gov.Rating", topics = 5,
model = STM, method = "pointestimate",
xlab = "Mean topic proportion: Environmental issues",
main = "Effect of Political Position (Left-Right Axis)",
labeltype = "custom",
custom.labels = c("Left-wing", "Centre-right", "Centre-left", "Centre", "Right-wing"))
plot(predict_topics, covariate = "Gov.Rating", topics = 1, #experiment
model = STM, method = "pointestimate",
main = "Effect of Political Position (Left-Right Axis)")
plot(x = predict_topics, covariate = "Year", method = "continuous", topics = c(5),
model = STM, xlab = "Time in years (1971-2022)")
plot(predict_topics, covariate = "Year", method = "continuous", topics = c(5),
model = z, xlab = "Time in years (1971-2022)")
plot(predict_topics, covariate = "Year", method = "continuous", topics = c(5),
model = STM, xlab = "Time in years (1971-2022)")
plot(predict_topics, covariate = "Year", method = "continuous", topics = c(5, 3),
model = STM, xlab = "Time in years (1971-2022)")
plot(predict_topics, covariate = "Year", method = "continuous", topics = c(5),
model = STM, xlab = "Time in years (1971-2022)", labels("Topic 5" = "Environmental Issues"))
plot(predict_topics, covariate = "Year", method = "continuous", topics = c(5),
model = STM, xlab = "Time in years (1971-2022)", labels("Topic 5" == "Environmental Issues"))
plot(predict_topics, covariate = "Year", method = "continuous", topics = c(5),
model = STM, xlab = "Time in years (1971-2022)", col = "green")
plot(predict_topics, covariate = "Year", method = "continuous", topics = c(5),
model = STM, xlab = "Time in years (1971-2022)")
plot(predict_topics, covariate = "Year", method = "continuous", topics = c(5),
model = STM, xlab = "Time in years (1971-2022)", legend("topleft", c("Environmental issues")))
plot(predict_topics, covariate = "Year", method = "continuous", topics = c(5),
model = STM, xlab = "Time in years (1971-2022)", legend("topleft", c("Environmental issues")))
plot(predict_topics, covariate = "Year", method = "continuous", topics = c(5),
model = STM, xlab = "Time in years (1971-2022)", legend("topleft", "Environmental issues"))
set.seed(832)
plot(STM,
type="perspectives",
topics=5,
covarlevels = c(1,5),
plabels=c("Gov.Rating = 1", "Gov.Rating = 5"),
main = "Environmental Issues")
set.seed(832)
plot(STM,
type="perspectives",
topics=5,
covarlevels = c(1,5),
plabels = c("Gov.Rating = 1", "Gov.Rating = 5"),
main = "Environmental Issues")
set.seed(832)
plot(STM,
type="perspectives",
topics=5,
covarlevels = 1:5,
plabels = c("Gov.Rating = 1", "Gov.Rating = 5"),
main = "Environmental Issues")
set.seed(832)
plot(STM,
type="perspectives",
topics=5,
plabels = c("Gov.Rating = 1", "Gov.Rating = 5"),
main = "Environmental Issues")
plot(STM,
type="perspectives",
topics=5,
main = "Environmental Issues")
plot(predict_topics, covariate = "Year", method = "continuous", topics = c(5),
model = STM, xlab = "Time in years (1971-2022)")
plot(predict_topics, covariate = "Year", method = "continuous", topics = c(5, 3, 4),
model = STM, xlab = "Time in years (1971-2022)")
findingk <- searchK(output$documents, output$vocab, K = c(3:20), prevalence =~ Gov.Rating + Year, data = meta, verbose=FALSE)
